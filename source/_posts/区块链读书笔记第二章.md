---
title: 区块链读书笔记第二章
date: 2018-01-23 17:38:44
tags:
---

## 分布式共识

中心化系统大家都信任中心化数据库的数据，分布式系统每人都有自己的数据库，那么首先要解决的就是应该相信谁的问题，也就是共识。

分布式共识协议: 在有n个节点的系统中，每一个节点都有一个输入值，其中一些节点具有故障。分布式共识协议具有以下两个属性:

1. 输入值的终止经由所有诚实节点来确定
2. 这个输入值必须由诚实节点来生成

交易A发生，在不同节点可能有这个交易也可能没有，如果一个节点获取打包权，并且此时它的交易池里面没有交易A，他照样打包。交易A将在之后的打包中被打入区块。

区块链是通过奖励机制和随机性，在货币领域实现了分布式共识。

### 奖励机制和工作量证明

给与表现诚实的节点奖励

#### 区块奖励

创造区块的节点可以在这个区块中加入一笔特别的交易，创造一笔交易赋予某地址一定数量的比特币作为奖励。这就是节点在共识链上进行创建区块服务的报酬。

一个节点想获取打包的节点的奖励，那么就希望节点打包的区块被纳入共识链。如果节点打包区块内部有造假交易，没有被纳入共识链。那么这个节点打包的奖励也无法获得。这样就引导了大部分节点为了奖励，都成为诚实的节点。

#### 交易费

交易制造者可以选择让输出值比输入值小，差额作为交易费。第一个创建区块把这笔交易放进区块链的节点获得此差额。

#### 挖矿与工作量证明

我们按照占有某种资源的比例来选取节点，假定这种资源是无法垄断的。
如果这种资源是计算能力，那么就是工作量证明(proof of work)(POW)
如果这种资源是某种币的拥有量，那么就是权益证明(proof of stake)(POS)

比特币采用的是POW
POW 就是找到一个随机数满足特定哈希谜题

这个哈希谜题有三个要求: 

1. 难于计算：2014年底产生一个区块平均要做10的20次方次哈希运算
2. 可参数化成本：难度是可以通过参数进行调整
3. 易于证实：证明那个随机数是否正确十分简单。

> 博弈论问题，大赞nash
> 每个节点都在充分考虑其他节点的潜在可能策略之后，制定自己策略，以期获得最大的回报。
> 所以问题是，矿工默认的诚实的行为是否达到纳什均衡。这个书上说还在研究

关于双花和51%算力攻击问题，可以看这个回答[比特币是如何防范双花的](https://zhuanlan.zhihu.com/p/25692826)